<!DOCTYPE html>
<html>
<head>
  <title>Simple Sprite Test</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #333;
      color: #fff;
      font-family: monospace;
    }
    #game-container {
      border: 2px solid #fff;
      margin: 20px 0;
    }
    .log {
      padding: 5px;
      margin: 2px 0;
      background: #222;
    }
    .error { color: #ff6b6b; }
    .success { color: #51cf66; }
    .info { color: #4dabf7; }
  </style>
</head>
<body>
  <h1>ðŸ§ª Simple Sprite Loading Test</h1>
  <div id="log"></div>
  <div id="game-container"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.70.0/phaser.min.js"></script>
  <script>
    const log = document.getElementById('log');

    function addLog(message, type = 'info') {
      const div = document.createElement('div');
      div.className = `log ${type}`;
      div.textContent = message;
      log.appendChild(div);
    }

    class TestScene extends Phaser.Scene {
      constructor() {
        super('TestScene');
      }

      preload() {
        addLog('Starting preload...', 'info');

        // Load atlases
        this.load.atlas('terrain', 'terrain_flora.png', 'terrain_flora.json');
        this.load.atlas('fish', 'fish_characters.png', 'fish_characters.json');

        this.load.on('filecomplete', (key, type, data) => {
          addLog(`Loaded: ${key}`, 'success');
        });

        this.load.on('loaderror', (file) => {
          addLog(`ERROR loading: ${file.key} - ${file.src}`, 'error');
        });

        this.load.on('complete', () => {
          addLog('All files loaded!', 'success');
        });
      }

      create() {
        addLog('Create phase started', 'info');

        // Check if atlases loaded
        if (!this.textures.exists('terrain')) {
          addLog('ERROR: terrain atlas not found!', 'error');
          return;
        }
        if (!this.textures.exists('fish')) {
          addLog('ERROR: fish atlas not found!', 'error');
          return;
        }

        addLog('Both atlases exist!', 'success');

        // Get frame names
        const terrainFrames = this.textures.get('terrain').getFrameNames();
        const fishFrames = this.textures.get('fish').getFrameNames();

        addLog(`Terrain frames: ${terrainFrames.length}`, 'info');
        addLog(`Fish frames: ${fishFrames.length}`, 'info');

        // Try to create some test sprites
        let y = 100;
        const testSprites = [
          { atlas: 'fish', frame: 'char_child', label: 'Child Character' },
          { atlas: 'fish', frame: 'char_adult', label: 'Adult Character' },
          { atlas: 'fish', frame: 'fish_blue', label: 'Blue Fish' },
          { atlas: 'fish', frame: 'fish_yellow', label: 'Yellow Fish' },
          { atlas: 'terrain', frame: 'palm_big', label: 'Big Palm' },
          { atlas: 'terrain', frame: 'sand_irregular', label: 'Sand' },
        ];

        testSprites.forEach(test => {
          try {
            const sprite = this.add.image(100, y, test.atlas, test.frame);
            sprite.setScale(2);

            // Add label
            this.add.text(200, y, `${test.label} (${test.frame})`, {
              fontSize: '16px',
              fill: '#fff',
              stroke: '#000',
              strokeThickness: 2
            }).setOrigin(0, 0.5);

            addLog(`âœ“ Created: ${test.label}`, 'success');

            // Check frame info
            const frame = sprite.frame;
            addLog(`  Frame size: ${frame.width}x${frame.height} at (${frame.x}, ${frame.y})`, 'info');

            y += 80;
          } catch (error) {
            addLog(`âœ— Failed to create: ${test.label} - ${error.message}`, 'error');
          }
        });

        // Add background
        this.add.rectangle(400, 300, 800, 600, 0x87CEEB, 0.3).setDepth(-1);

        addLog('Scene setup complete!', 'success');
      }
    }

    new Phaser.Game({
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      parent: 'game-container',
      backgroundColor: '#87CEEB',
      scene: TestScene,
      render: {
        pixelArt: true,
        antialias: false
      }
    });
  </script>
</body>
</html>
